from MapGrid import MapGrid
from Player import Player
from ApiWrapper import ApiWrapper
import time

api = ApiWrapper("http://localhost:6001")
bot = Player(api)
buffs = bot.findBuffs()
mapGrid = MapGrid()

importantPositions = [
(1055.99499512, -3608.25219727),
(1055.9375, -3464.43139648),
(1056.82019043, -3256.72119141),
(1077.06518555, -3057.1081543),
(1176.42089844, -2955.43652344),
(1276.49279785, -2891.36621094),
(1303.10827637, -2764.28955078),
(1320.08496094, -2615.18701172),
(1461.60302734, -2499.56005859),
(1519.8190918, -2465.81884766),
(1519.8190918, -2465.37719727),
(1734.56713867, -2512.55126953),
(1925.91772461, -2599.75756836),
(2147.78198242, -2668.42919922),
(2397.47973633, -2677.48974609),
(2653.96459961, -2648.70092773),
(2873.45581055, -2705.35668945),
(2971.22094727, -2853.54150391),
(2997.92529297, -3046.66430664),
(2960.48803711, -3160.61083984),
(2990.87036133, -3248.04785156),
(3126.30712891, -3337.53417969),
(3091.61914062, -3379.27587891),
(2989.67480469, -3634.71362305),
(2992.92456055, -3932.13818359),
(3004.67089844, -3999.80615234),
(3005.11914062, -4010.1496582),
(3033.58789062, -4258.21484375),
(3050.74755859, -4258.21484375),
(3043.72143555, -4468.32910156),
(3006.39599609, -4615.97460938),
(3005.59936523, -4660.13378906),
(2932.62402344, -4779.81396484),
(2928.16381836, -4779.43066406)]

importantPositions = [
(1055.87744141,-3315.34985352),
(1055.7989502,-3121.4206543),
(1055.7644043,-3040.0480957),
(1131.0456543,-2987.71166992),
(1249.48999023,-2908.50830078),
(1283.54980469,-2883.61132812),
(1310.43762207,-2648.84472656),
(1326.97949219,-2557.91625977),
(1448.74450684,-2517.85961914),
(1519.92663574,-2499.73486328),
(1519.92663574,-2499.73486328),
(1589.20495605,-2503.90332031),
(1811.73718262,-2548.25512695),
(1953.49450684,-2635.69287109),
(2096.69091797,-2680.94580078),
(2262.55883789,-2670.57885742),
(2365.03588867,-2657.5871582),
(2510.87182617,-2641.3347168),
(2670.41113281,-2664.80615234),
(2879.46484375,-2705.35717773),
(2965.12646484,-2819.53027344),
(3011.40625,-2994.46679688),
(3025.05517578,-3212.00634766),
(3065.03125,-3486.92260742),
(3058.23754883,-3631.60400391),
(3013.56103516,-3836.30249023),
(3009.74511719,-3999.90356445),
(3010.87988281,-4056.29394531),
(3056.82275391,-4263.56787109),
(3051.37988281,-4463.56445312),
(3022.33935547,-4591.80810547),
(2996.46069336,-4690.90283203),
(2928.13500977,-4768.765625),
(2928.13500977,-4768.765625),
(2928.13500977,-4768.765625)
]

time.sleep(2) # 5 seconds to get ready
for importantPos in importantPositions:
    bot.refreshSelfInfo()
    start = (bot.x, bot.y)
    end = (importantPos[0], importantPos[1])
    start = mapGrid.transformPos(start)
    end = mapGrid.transformPos(end)
    foundPath = list(mapGrid.astar(start, end))
    
    for i in range(0, len(foundPath), 4):
        bot.use()
        time.sleep(0.5)
        position = mapGrid.transformPosBack(foundPath[i])
        print "Moving to " + str(position[0]) + ":" + str(position[1])
        bot.moveTo(position[0], position[1])
        time.sleep(1)
        
    print "Position reached. " + str(importantPos[0]) + ":" + str(importantPos[1])